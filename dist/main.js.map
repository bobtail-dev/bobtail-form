{"version":3,"sources":["../src/main.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;oBAwBe,UAAU,OAAV,EAAqC;AAAA,QAAlB,aAAkB,uEAAJ,EAAI;;AAClD,QAAI,OAAO,8BAAa,EAAb,CAAX;AACA,QAAI,QAAQ,QAAQ,IAAR,CAAZ;;AAEA,QAAI,UAAU,sBAAE,MAAM,CAAN,CAAF,CAAd;AACA,QAAI,eAAe,KAAnB;AACA,QAAI,cAAc,SAAd,WAAc,GAAM;AACtB,2BAAK;AAAA,eAAM,KAAK,IAAL,GAAY,QAAQ,aAAR,CAAsB,aAAtB,CAAlB;AAAA,OAAL;AACA,qBAAe,KAAf;AACD,KAHD;AAIA,QAAI,IAAI,SAAJ,CAAI,GAAM;AACZ,UAAG,CAAC,YAAJ,EAAiB;AACf,uBAAe,IAAf;AACA,eAAO,qBAAP,CAA6B,WAA7B;AACD;AACF,KALD;;AAOA;AACA,kCAAoB;AAClB,gBAAU,CADQ;AAElB,gBAAU,MAAM,CAAN,CAFQ;AAGlB,eAAS,CACP,EAAC,SAAS,yBAAV,EADO,EAEP,EAAC,WAAW,OAAZ,EAFO,EAGP,EAAC,WAAW,UAAZ,EAHO,EAIP,EAAC,WAAW,SAAZ,EAJO,EAKP,EAAC,WAAW,MAAZ,EALO;AAHS,KAApB;;AAYA,YAAQ,EAAR,CAAW,QAAX,EAAqB,yBAArB,EAAgD,CAAhD;AACA,WAAO,EAAC,YAAD,EAAQ,UAAR,EAAP;AACD,G;;;;;;;;;;;;AAxDD;;;;;;;;;;AAwDC;;AAxCD","file":"main.js","sourcesContent":["/**\n * A bobtail extension for building forms with two-way data binding\n * @author Richard Mehlinger\n * @copyright (c) 2017 Richard Mehlinger\n * @license MIT\n * @module bobtail-form\n * @overview An extension to the [bobtail](github.com/bobtail-dev/bobtail) programming framework, implementing\n *           forms with two way data-binding.\n*/\n\nimport $ from 'jquery';\nimport {snap} from 'bobtail-rx';\nimport 'jquery-serializejson';\nimport {JsonCell} from 'bobtail-json-cell';\nimport MutationSummary from 'mutation-summary';\n\n/**\n * generates a jQuery form and a JsonCell bound to its current serialization, and returns an object containing both.\n * @param {function} $formFn - Function to create the form. Takes a single argument, the JsonCell to which the form is serialized.\n * @param {object} serializeOpts - options object to pass to jquery.serializeJson\n * @param {number} lag - form will be reserialized at most once every lag milliseconds--see http://underscorejs.org/#debounce\n * @returns {{$form: jQuery, cell: JsonCell}}\n */\n\nexport default function ($formFn, serializeOpts={}) {\n  let cell = new JsonCell({});\n  let $form = $formFn(cell);\n\n  let $target = $($form[0]);\n  let updateQueued = false;\n  let updateFrame = () => {\n    snap(() => cell.data = $target.serializeJSON(serializeOpts));\n    updateQueued = false;\n  };\n  let s = () => {\n    if(!updateQueued){\n      updateQueued = true;\n      window.requestAnimationFrame(updateFrame);\n    }\n  };\n\n  s();\n  new MutationSummary({\n    callback: s,\n    rootNode: $form[0],\n    queries: [\n      {element: 'input, select, textarea'},\n      {attribute: 'value'},\n      {attribute: 'selected'},\n      {attribute: 'checked'},\n      {attribute: 'name'}\n    ]\n  });\n\n  $target.on('change', 'input, select, textarea', s);\n  return {$form, cell};\n};"]}